(function(t){function e(e){for(var i,o,r=e[0],c=e[1],h=e[2],l=0,p=[];l<r.length;l++)o=r[l],Object.prototype.hasOwnProperty.call(s,o)&&s[o]&&p.push(s[o][0]),s[o]=0;for(i in c)Object.prototype.hasOwnProperty.call(c,i)&&(t[i]=c[i]);u&&u(e);while(p.length)p.shift()();return a.push.apply(a,h||[]),n()}function n(){for(var t,e=0;e<a.length;e++){for(var n=a[e],i=!0,r=1;r<n.length;r++){var c=n[r];0!==s[c]&&(i=!1)}i&&(a.splice(e--,1),t=o(o.s=n[0]))}return t}var i={},s={app:0},a=[];function o(e){if(i[e])return i[e].exports;var n=i[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,o),n.l=!0,n.exports}o.m=t,o.c=i,o.d=function(t,e,n){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},o.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)o.d(n,i,function(e){return t[e]}.bind(null,i));return n},o.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="/";var r=window["webpackJsonp"]=window["webpackJsonp"]||[],c=r.push.bind(r);r.push=e,r=r.slice();for(var h=0;h<r.length;h++)e(r[h]);var u=c;a.push([0,"chunk-vendors"]),n()})({0:function(t,e,n){t.exports=n("56d7")},"35c1":function(t,e,n){},"56d7":function(t,e,n){"use strict";n.r(e);n("e260"),n("e6cf"),n("cca6"),n("a79d");var i=n("2b0e"),s=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"app"}},[t._m(0),n("div",{staticClass:"tools"},[n("div",{staticClass:"palette"},t._l(t.palette,(function(e,i){return n("div",{key:e,staticClass:"palette-item",class:{active:t.current===i},style:{background:e},on:{click:function(e){return t.changeColor(i)}}})})),0),n("div",{staticClass:"size"},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.size,expression:"size"}],attrs:{type:"range",min:"5",max:"20"},domProps:{value:t.size},on:{change:t.changeSize,__r:function(e){t.size=e.target.value}}}),n("span",[t._v(t._s(t.size))])]),n("button",{on:{click:t.clearCanvas}},[t._v("重置")])])])},a=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"main"},[n("canvas",{attrs:{id:"drawBoard",width:"700",height:"400"}})])}],o=n("5de2"),r=n.n(o),c={data:function(){return{palette:["#333","#e91e63","#673ab7","#2196f3","#4caf50"],current:0,size:6,irealtime:null}},watch:{size:function(t){this.ctx.lineWidth=t},current:function(t){this.publish(JSON.stringify({type:"changeColor",current:t}))}},mounted:function(){var t=this;this.irealtime=new r.a({host:"hk.irealtime.cn",appkey:"evwgarjidaqzkh3twfiz5uv10ukqagwg",onConnected:function(){console.log("连接成功...")},onDisconnected:function(){console.log("连接断开...")},onConnectFailed:function(t){console.log("连接失败...",t)}}),this.irealtime.subscribe({channels:["mychannel"],onMessage:function(e){console.log(t.path),t.syncPath(e.message)},onSuccess:function(){},onFailed:function(){}}),this.canvas=document.getElementById("drawBoard"),this.ctx=this.canvas.getContext("2d"),this.stage_info=this.canvas.getBoundingClientRect(),this.path={beginX:0,beginY:0,endX:0,endY:0},this.ctx.lineWidth=this.size,this.isDraw=!1,this.draw()},methods:{draw:function(){var t=this,e=this;this.canvas.onmousedown=function(n){e.ctx.beginPath(),e.path.beginX=n.pageX-e.stage_info.left,e.path.beginY=n.pageY-e.stage_info.top,e.ctx.moveTo(e.path.beginX,e.path.beginY),e.isDraw=!0,t.publish(JSON.stringify({type:"mousedown",path:t.path}))},this.canvas.onmousemove=function(t){e.isDraw&&e.drawing(t)},this.canvas.onmouseup=function(){e.isDraw=!1,t.publish(JSON.stringify({type:"stop",path:t.path}))}},drawing:function(t){this.path.endX=t.pageX-this.stage_info.left,this.path.endY=t.pageY-this.stage_info.top,this.ctx.lineTo(this.path.endX,this.path.endY),this.ctx.stroke();var e={type:"draw",size:this.size,current:this.current,path:this.path};this.publish(JSON.stringify(e))},syncPath:function(t){var e=JSON.parse(t),n=e.type,i=e.size,s=e.current,a=e.path;return"changeColor"===n?(this.current=s,void(this.ctx.strokeStyle=this.palette[this.current])):"changeSize"===n?(this.size=i,void(this.ctx.lineWidth=this.size)):void("clear"!=n?(this.path.beginX!=a.beginX&&(console.log("mousedown"===n),"mousedown"===n?(this.ctx.beginPath(),this.ctx.moveTo(a.beginX,a.beginY),this.isDraw=1):"draw"===n&&1===this.isDraw&&(this.ctx.lineTo(a.endX,a.endY),this.ctx.stroke())),"stop"===n&&(this.isDraw=0)):this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height))},clearCanvas:function(){this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.goal="",this.publish(JSON.stringify({type:"clear"}))},changeColor:function(t){this.current=t,this.ctx.strokeStyle=this.palette[t]},changeSize:function(t){this.publish(JSON.stringify({type:"changeSize",size:t.target.value}))},publish:function(t){this.irealtime.publish({channel:"mychannel",message:t,onSuccess:function(t){console.log("success:",t)},onFailed:function(t){console.log("failed:",t)}})}}},h=c,u=(n("bf1f"),n("2877")),l=Object(u["a"])(h,s,a,!1,null,"1c0e3fec",null),p=l.exports;i["a"].config.productionTip=!1,new i["a"]({render:function(t){return t(p)}}).$mount("#app")},bf1f:function(t,e,n){"use strict";n("35c1")}});
//# sourceMappingURL=app.5b94d0b5.js.map